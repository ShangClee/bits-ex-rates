<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BITS Exchange Rates</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .last-update {
            color: #666;
            font-size: 14px;
        }
        
        .rates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .rate-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .rate-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .currency-info {
            display: flex;
            align-items: center;
        }
        
        .currency-flag {
            width: 24px;
            height: 18px;
            margin-right: 10px;
            border-radius: 2px;
        }
        
        .currency-name {
            font-weight: bold;
            color: #333;
        }
        
        .rate-value {
            font-size: 18px;
            font-weight: bold;
            color: #2563eb;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            color: #dc2626;
            background: #fef2f2;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .refresh-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px auto;
            display: block;
        }
        
        .refresh-btn:hover {
            background: #1d4ed8;
        }
        
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #1e40af;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>BITS Exchange Rates</h1>
        <div class="info-box">
            1 BITS = 1,000,000 satoshis = 0.000001 Bitcoin
        </div>
        <div class="last-update" id="lastUpdate">Loading...</div>
        <button class="refresh-btn" onclick="fetchRates()">Refresh Rates</button>
    </div>

    <div id="loading" class="loading">
        Loading exchange rates...
    </div>

    <div id="error" class="error" style="display: none;"></div>

    <div id="ratesContainer" class="rates-grid" style="display: none;"></div>

    <script>
        // Currency configurations with symbols and names
        const currencies = {
            'usd': { name: 'US Dollar', symbol: '$', flag: 'ðŸ‡ºðŸ‡¸' },
            'eur': { name: 'Euro', symbol: 'â‚¬', flag: 'ðŸ‡ªðŸ‡º' },
            'gbp': { name: 'British Pound', symbol: 'Â£', flag: 'ðŸ‡¬ðŸ‡§' },
            'jpy': { name: 'Japanese Yen', symbol: 'Â¥', flag: 'ðŸ‡¯ðŸ‡µ' },
            'aud': { name: 'Australian Dollar', symbol: 'A$', flag: 'ðŸ‡¦ðŸ‡º' },
            'cad': { name: 'Canadian Dollar', symbol: 'C$', flag: 'ðŸ‡¨ðŸ‡¦' },
            'chf': { name: 'Swiss Franc', symbol: 'CHF', flag: 'ðŸ‡¨ðŸ‡­' },
            'cny': { name: 'Chinese Yuan', symbol: 'Â¥', flag: 'ðŸ‡¨ðŸ‡³' },
            'sek': { name: 'Swedish Krona', symbol: 'kr', flag: 'ðŸ‡¸ðŸ‡ª' },
            'nzd': { name: 'New Zealand Dollar', symbol: 'NZ$', flag: 'ðŸ‡³ðŸ‡¿' },
            'mxn': { name: 'Mexican Peso', symbol: '$', flag: 'ðŸ‡²ðŸ‡½' },
            'sgd': { name: 'Singapore Dollar', symbol: 'S$', flag: 'ðŸ‡¸ðŸ‡¬' },
            'hkd': { name: 'Hong Kong Dollar', symbol: 'HK$', flag: 'ðŸ‡­ðŸ‡°' },
            'nok': { name: 'Norwegian Krone', symbol: 'kr', flag: 'ðŸ‡³ðŸ‡´' },
            'try': { name: 'Turkish Lira', symbol: 'â‚º', flag: 'ðŸ‡¹ðŸ‡·' },
            'zar': { name: 'South African Rand', symbol: 'R', flag: 'ðŸ‡¿ðŸ‡¦' },
            'brl': { name: 'Brazilian Real', symbol: 'R$', flag: 'ðŸ‡§ðŸ‡·' },
            'inr': { name: 'Indian Rupee', symbol: 'â‚¹', flag: 'ðŸ‡®ðŸ‡³' },
            'krw': { name: 'South Korean Won', symbol: 'â‚©', flag: 'ðŸ‡°ðŸ‡·' },
            'twd': { name: 'Taiwan Dollar', symbol: 'NT$', flag: 'ðŸ‡¹ðŸ‡¼' }
        };

        async function fetchRates() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            const containerEl = document.getElementById('ratesContainer');
            
            // Show loading state
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            containerEl.style.display = 'none';

            try {
                const currencyList = Object.keys(currencies).join(',');
                
                // Use a CORS proxy for local development
                const isLocal = window.location.protocol === 'file:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                const apiUrl = isLocal 
                    ? `https://api.allorigins.win/get?url=${encodeURIComponent(`https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${currencyList}`)}`
                    : `https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${currencyList}`;
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Handle different response formats
                const bitcoinRates = isLocal ? JSON.parse(data.contents).bitcoin : data.bitcoin;
                
                if (!bitcoinRates) {
                    throw new Error('Invalid data format received');
                }
                
                displayRates(bitcoinRates);
                updateLastUpdateTime();
                
            } catch (error) {
                console.error('Error fetching rates:', error);
                showError(`Failed to fetch exchange rates: ${error.message}. Try hosting the file on a web server or use the manual solution below.`);
                
                // Show fallback manual rates for testing
                showFallbackRates();
            }
        }

        function showFallbackRates() {
            // Sample rates for testing when API fails
            const sampleRates = {
                'usd': 0.000043, 'eur': 0.000039, 'gbp': 0.000034, 'jpy': 0.0064,
                'aud': 0.000065, 'cad': 0.000058, 'chf': 0.000038, 'cny': 0.00031,
                'sek': 0.00046, 'nzd': 0.000071, 'mxn': 0.00074, 'sgd': 0.000058,
                'hkd': 0.00034, 'nok': 0.00047, 'try': 0.00148, 'zar': 0.00078,
                'brl': 0.00022, 'inr': 0.0036, 'krw': 0.057, 'twd': 0.00139
            };
            
            setTimeout(() => {
                document.getElementById('error').innerHTML = `
                    <strong>API Error - Showing Sample Rates</strong><br>
                    For live rates, please host this file on a web server.<br>
                    <small>Quick fix: Use Python: <code>python -m http.server 8000</code> then visit <code>http://localhost:8000</code></small>
                `;
                displayRates(sampleRates);
            }, 2000);
        }

        function displayRates(bitcoinRates) {
            const container = document.getElementById('ratesContainer');
            container.innerHTML = '';

            Object.entries(currencies).forEach(([code, config]) => {
                if (bitcoinRates[code]) {
                    const bitcoinPrice = bitcoinRates[code];
                    const bitsRate = bitcoinPrice / 1000000; // Convert BTC to BITS (1 BTC = 1M BITS)
                    
                    const rateCard = createRateCard(code, config, bitsRate);
                    container.appendChild(rateCard);
                }
            });

            // Hide loading and show results
            document.getElementById('loading').style.display = 'none';
            container.style.display = 'grid';
        }

        function createRateCard(currencyCode, config, rate) {
            const card = document.createElement('div');
            card.className = 'rate-card';
            
            // Format the rate with appropriate decimal places
            let formattedRate;
            if (rate >= 1) {
                formattedRate = rate.toFixed(2);
            } else if (rate >= 0.01) {
                formattedRate = rate.toFixed(4);
            } else {
                formattedRate = rate.toFixed(6);
            }
            
            card.innerHTML = `
                <div class="currency-info">
                    <span class="currency-flag">${config.flag}</span>
                    <div>
                        <div class="currency-name">${config.name}</div>
                        <div style="font-size: 12px; color: #666;">${currencyCode.toUpperCase()}</div>
                    </div>
                </div>
                <div class="rate-value">
                    ${config.symbol}${formattedRate}
                </div>
            `;
            
            return card;
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
            document.getElementById('loading').style.display = 'none';
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleString();
            document.getElementById('lastUpdate').textContent = `Last updated: ${timeString}`;
        }

        // Auto-refresh every hour (3600000 ms)
        setInterval(fetchRates, 3600000);

        // Initial load
        fetchRates();
    </script>
</body>
</html>
