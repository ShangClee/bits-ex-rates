<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BITS Exchange Rates</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .nav-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.2s;
        }
        
        .nav-btn:hover {
            background: #1d4ed8;
        }
        
        .nav-btn.active {
            background: #1e40af;
            font-weight: bold;
        }
        
        .last-update {
            color: #666;
            font-size: 14px;
        }
        
        .rates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .rate-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .rate-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .currency-info {
            display: flex;
            align-items: center;
        }
        
        .currency-flag {
            width: 24px;
            height: 18px;
            margin-right: 10px;
            border-radius: 2px;
        }
        
        .currency-name {
            font-weight: bold;
            color: #333;
        }
        
        .rate-value {
            font-size: 18px;
            font-weight: bold;
            color: #2563eb;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            text-align: center;
            padding: 40px;
            color: #dc2626;
            background: #fef2f2;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .refresh-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px auto;
            display: block;
        }
        
        .refresh-btn:hover {
            background: #059669;
        }
        
        .info-box {
            background: #eff6ff;
            border: 1px solid #bfdbfe;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            color: #1e40af;
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        .page-title {
            text-align: center;
            color: #374151;
            margin: 20px 0;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>BITS Exchange Rates</h1>
        <div class="info-box">
            1 BITS = 1,000,000 satoshis = 0.000001 Bitcoin
        </div>
        
        <div class="navigation">
            <button class="nav-btn active" onclick="showPage('fiat-per-bits')">Fiat per 1 BITS</button>
            <button class="nav-btn" onclick="showPage('bits-per-fiat')">BITS per Fiat</button>
        </div>
        
        <div class="last-update" id="lastUpdate">Loading...</div>
        <button class="refresh-btn" onclick="fetchRates()">Refresh Rates</button>
    </div>

    <div id="loading" class="loading">
        Loading exchange rates...
    </div>

    <div id="error" class="error" style="display: none;"></div>

    <!-- Page 1: Fiat per 1 BITS -->
    <div id="fiat-per-bits" class="page active">
        <div class="page-title">How much fiat currency per 1 BITS</div>
        <div id="fiatPerBitsContainer" class="rates-grid" style="display: none;"></div>
    </div>

    <!-- Page 2: BITS per Fiat -->
    <div id="bits-per-fiat" class="page">
        <div class="page-title">How many BITS you can buy with major fiat amounts</div>
        <div id="bitsPerFiatContainer" class="rates-grid" style="display: none;"></div>
    </div>

    <script>
        // Currency configurations with symbols and names
        const currencies = {
            'usd': { name: 'US Dollar', symbol: '$', flag: 'ðŸ‡ºðŸ‡¸', amounts: [1, 10, 100] },
            'eur': { name: 'Euro', symbol: 'â‚¬', flag: 'ðŸ‡ªðŸ‡º', amounts: [1, 10, 100] },
            'gbp': { name: 'British Pound', symbol: 'Â£', flag: 'ðŸ‡¬ðŸ‡§', amounts: [1, 10, 100] },
            'jpy': { name: 'Japanese Yen', symbol: 'Â¥', flag: 'ðŸ‡¯ðŸ‡µ', amounts: [100, 1000, 10000] },
            'aud': { name: 'Australian Dollar', symbol: 'A$', flag: 'ðŸ‡¦ðŸ‡º', amounts: [1, 10, 100] },
            'cad': { name: 'Canadian Dollar', symbol: 'C$', flag: 'ðŸ‡¨ðŸ‡¦', amounts: [1, 10, 100] },
            'chf': { name: 'Swiss Franc', symbol: 'CHF', flag: 'ðŸ‡¨ðŸ‡­', amounts: [1, 10, 100] },
            'cny': { name: 'Chinese Yuan', symbol: 'Â¥', flag: 'ðŸ‡¨ðŸ‡³', amounts: [1, 10, 100] },
            'sek': { name: 'Swedish Krona', symbol: 'kr', flag: 'ðŸ‡¸ðŸ‡ª', amounts: [10, 100, 1000] },
            'nzd': { name: 'New Zealand Dollar', symbol: 'NZ$', flag: 'ðŸ‡³ðŸ‡¿', amounts: [1, 10, 100] },
            'mxn': { name: 'Mexican Peso', symbol: '$', flag: 'ðŸ‡²ðŸ‡½', amounts: [10, 100, 1000] },
            'sgd': { name: 'Singapore Dollar', symbol: 'S$', flag: 'ðŸ‡¸ðŸ‡¬', amounts: [1, 10, 100] },
            'hkd': { name: 'Hong Kong Dollar', symbol: 'HK$', flag: 'ðŸ‡­ðŸ‡°', amounts: [10, 100, 1000] },
            'nok': { name: 'Norwegian Krone', symbol: 'kr', flag: 'ðŸ‡³ðŸ‡´', amounts: [10, 100, 1000] },
            'try': { name: 'Turkish Lira', symbol: 'â‚º', flag: 'ðŸ‡¹ðŸ‡·', amounts: [10, 100, 1000] },
            'zar': { name: 'South African Rand', symbol: 'R', flag: 'ðŸ‡¿ðŸ‡¦', amounts: [10, 100, 1000] },
            'brl': { name: 'Brazilian Real', symbol: 'R$', flag: 'ðŸ‡§ðŸ‡·', amounts: [1, 10, 100] },
            'inr': { name: 'Indian Rupee', symbol: 'â‚¹', flag: 'ðŸ‡®ðŸ‡³', amounts: [10, 100, 1000] },
            'krw': { name: 'South Korean Won', symbol: 'â‚©', flag: 'ðŸ‡°ðŸ‡·', amounts: [1000, 10000, 100000] },
            'twd': { name: 'Taiwan Dollar', symbol: 'NT$', flag: 'ðŸ‡¹ðŸ‡¼', amounts: [10, 100, 1000] }
        };

        let currentRates = {};

        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Remove active class from all nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected page
            document.getElementById(pageId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // Update display if we have rates
            if (Object.keys(currentRates).length > 0) {
                if (pageId === 'fiat-per-bits') {
                    displayFiatPerBits(currentRates);
                } else {
                    displayBitsPerFiat(currentRates);
                }
            }
        }

        async function fetchRates() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');
            
            // Show loading state
            loadingEl.style.display = 'block';
            errorEl.style.display = 'none';
            hideAllContainers();

            try {
                const currencyList = Object.keys(currencies).join(',');
                
                // Use a CORS proxy for local development
                const isLocal = window.location.protocol === 'file:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
                const apiUrl = isLocal 
                    ? `https://api.allorigins.win/get?url=${encodeURIComponent(`https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${currencyList}`)}`
                    : `https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=${currencyList}`;
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                
                // Handle different response formats
                const bitcoinRates = isLocal ? JSON.parse(data.contents).bitcoin : data.bitcoin;
                
                if (!bitcoinRates) {
                    throw new Error('Invalid data format received');
                }
                
                currentRates = bitcoinRates;
                displayCurrentPage();
                updateLastUpdateTime();
                
            } catch (error) {
                console.error('Error fetching rates:', error);
                showError(`Failed to fetch exchange rates: ${error.message}. Try hosting the file on a web server.`);
                showFallbackRates();
            }
        }

        function hideAllContainers() {
            document.getElementById('fiatPerBitsContainer').style.display = 'none';
            document.getElementById('bitsPerFiatContainer').style.display = 'none';
        }

        function displayCurrentPage() {
            const activePage = document.querySelector('.page.active');
            if (activePage.id === 'fiat-per-bits') {
                displayFiatPerBits(currentRates);
            } else {
                displayBitsPerFiat(currentRates);
            }
        }

        function displayFiatPerBits(bitcoinRates) {
            const container = document.getElementById('fiatPerBitsContainer');
            container.innerHTML = '';

            Object.entries(currencies).forEach(([code, config]) => {
                if (bitcoinRates[code]) {
                    const bitcoinPrice = bitcoinRates[code];
                    const bitsRate = bitcoinPrice / 1000000; // Convert BTC to BITS
                    
                    const rateCard = createFiatPerBitsCard(code, config, bitsRate);
                    container.appendChild(rateCard);
                }
            });

            document.getElementById('loading').style.display = 'none';
            container.style.display = 'grid';
        }

        function displayBitsPerFiat(bitcoinRates) {
            const container = document.getElementById('bitsPerFiatContainer');
            container.innerHTML = '';

            Object.entries(currencies).forEach(([code, config]) => {
                if (bitcoinRates[code]) {
                    const bitcoinPrice = bitcoinRates[code];
                    const bitsRate = bitcoinPrice / 1000000; // Convert BTC to BITS rate
                    
                    config.amounts.forEach(amount => {
                        const bitsAmount = amount / bitsRate; // How many BITS you can buy
                        const rateCard = createBitsPerFiatCard(code, config, amount, bitsAmount);
                        container.appendChild(rateCard);
                    });
                }
            });

            document.getElementById('loading').style.display = 'none';
            container.style.display = 'grid';
        }

        function createFiatPerBitsCard(currencyCode, config, rate) {
            const card = document.createElement('div');
            card.className = 'rate-card';
            
            // Format the rate with appropriate decimal places
            let formattedRate;
            if (rate >= 1) {
                formattedRate = rate.toFixed(2);
            } else if (rate >= 0.01) {
                formattedRate = rate.toFixed(4);
            } else {
                formattedRate = rate.toFixed(6);
            }
            
            card.innerHTML = `
                <div class="currency-info">
                    <span class="currency-flag">${config.flag}</span>
                    <div>
                        <div class="currency-name">1 BITS</div>
                        <div style="font-size: 12px; color: #666;">${currencyCode.toUpperCase()}</div>
                    </div>
                </div>
                <div class="rate-value">
                    ${config.symbol}${formattedRate}
                </div>
            `;
            
            return card;
        }

        function createBitsPerFiatCard(currencyCode, config, fiatAmount, bitsAmount) {
            const card = document.createElement('div');
            card.className = 'rate-card';
            
            // Format BITS amount
            const formattedBits = bitsAmount >= 1000000 
                ? (bitsAmount / 1000000).toFixed(2) + 'M'
                : bitsAmount >= 1000
                ? (bitsAmount / 1000).toFixed(1) + 'K'
                : bitsAmount.toFixed(0);
            
            card.innerHTML = `
                <div class="currency-info">
                    <span class="currency-flag">${config.flag}</span>
                    <div>
                        <div class="currency-name">${config.symbol}${fiatAmount}</div>
                        <div style="font-size: 12px; color: #666;">${currencyCode.toUpperCase()}</div>
                    </div>
                </div>
                <div class="rate-value">
                    ${formattedBits} BITS
                </div>
            `;
            
            return card;
        }

        function showFallbackRates() {
            // Sample rates for testing when API fails
            const sampleRates = {
                'usd': 43000, 'eur': 39000, 'gbp': 34000, 'jpy': 6400000,
                'aud': 65000, 'cad': 58000, 'chf': 38000, 'cny': 310000,
                'sek': 460000, 'nzd': 71000, 'mxn': 740000, 'sgd': 58000,
                'hkd': 340000, 'nok': 470000, 'try': 1480000, 'zar': 780000,
                'brl': 220000, 'inr': 3600000, 'krw': 57000000, 'twd': 1390000
            };
            
            setTimeout(() => {
                document.getElementById('error').innerHTML = `
                    <strong>API Error - Showing Sample Rates</strong><br>
                    For live rates, please host this file on a web server.<br>
                    <small>Quick fix: Use Python: <code>python -m http.server 8000</code> then visit <code>http://localhost:8000</code></small>
                `;
                currentRates = sampleRates;
                displayCurrentPage();
            }, 2000);
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.innerHTML = message;
            errorEl.style.display = 'block';
            document.getElementById('loading').style.display = 'none';
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleString();
            document.getElementById('lastUpdate').textContent = `Last updated: ${timeString}`;
        }

        // Auto-refresh every hour (3600000 ms)
        setInterval(fetchRates, 3600000);

        // Initial load
        fetchRates();
    </script>
</body>
</html>
